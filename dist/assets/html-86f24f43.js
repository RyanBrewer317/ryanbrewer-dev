var pe=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var h=(e,t,n)=>(pe(e,t,"read from private field"),n?n.call(e):t.get(e)),_=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},o=(e,t,n,r)=>(pe(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var B=(e,t,n)=>(pe(e,t,"access private method"),n);class m{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}}class v{static fromArray(t,n){let r=n||new Ke;for(let s=t.length-1;s>=0;--s)r=new Xe(t[s],r);return r}[Symbol.iterator](){return new it(this)}toArray(){return[...this]}atLeastLength(t){for(let n of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let n of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let n of this)t++;return t}}function _e(e,t){return new Xe(e,t)}function l(e,t){return v.fromArray(e,t)}var U;class it{constructor(t){_(this,U,void 0);o(this,U,t)}next(){if(h(this,U)instanceof Ke)return{done:!0};{let{head:t,tail:n}=h(this,U);return o(this,U,n),{value:t,done:!1}}}}U=new WeakMap;class Ke extends v{}class Xe extends v{constructor(t,n){super(),this.head=t,this.tail=n}}class ie{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatAt(t){return ft(this.buffer.slice(t,t+8))}intFromSlice(t,n){return ut(this.buffer.slice(t,n))}binaryFromSlice(t,n){return new ie(this.buffer.slice(t,n))}sliceAfter(t){return new ie(this.buffer.slice(t))}}function ut(e){e=e.reverse();let t=0;for(let n=e.length-1;n>=0;n--)t=t*256+e[n];return t}function ft(e){return new Float64Array(e.reverse().buffer)[0]}class ee extends m{static isResult(t){return t instanceof ee}}class w extends ee{constructor(t){super(),this[0]=t}isOk(){return!0}}class O extends ee{constructor(t){super(),this[0]=t}isOk(){return!1}}function H(e,t){let n=[e,t];for(;n.length;){let r=n.pop(),s=n.pop();if(r===s)continue;if(!Fe(r)||!Fe(s)||!yt(r,s)||ct(r,s)||ot(r,s)||lt(r,s)||ht(r,s)||dt(r,s)||pt(r,s))return!1;const u=Object.getPrototypeOf(r);if(u!==null&&typeof u.equals=="function")try{if(r.equals(s))continue;return!1}catch{}let[f,c]=at(r);for(let a of f(r))n.push(c(r,a),c(s,a))}return!0}function at(e){if(e instanceof Map)return[t=>t.keys(),(t,n)=>t.get(n)];{let t=e instanceof globalThis.Error?["message"]:[];return[n=>[...t,...Object.keys(n)],(n,r)=>n[r]]}}function ct(e,t){return e instanceof Date&&(e>t||e<t)}function ot(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((n,r)=>n===t[r]))}function lt(e,t){return Array.isArray(e)&&e.length!==t.length}function ht(e,t){return e instanceof Map&&e.size!==t.size}function dt(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(n=>!t.has(n)))}function pt(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function Fe(e){return typeof e=="object"&&e!==null}function yt(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(r=>e instanceof r)?!1:e.constructor===t.constructor}function bn(e,t,n,r,s,i){let u=new globalThis.Error(s);u.gleam_error=e,u.module=t,u.line=n,u.fn=r;for(let f in i)u[f]=i[f];return u}class Z extends m{constructor(t){super(),this[0]=t}}class ue extends m{}function wt(e,t){if(e instanceof Z){let n=e[0];return new w(n)}else return new O(t)}function gn(e,t){if(e instanceof Z){let n=e[0];return new Z(t(n))}else return new ue}const Re=new WeakMap,ye=new DataView(new ArrayBuffer(8));let we=0;function me(e){const t=Re.get(e);if(t!==void 0)return t;const n=we++;return we===2147483647&&(we=0),Re.set(e,n),n}function be(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Ee(e){let t=0;const n=e.length;for(let r=0;r<n;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return t}function Ye(e){ye.setFloat64(0,e);const t=ye.getInt32(0),n=ye.getInt32(4);return Math.imul(73244475,t>>16^t)^n}function mt(e){return Ee(e.toString())}function bt(e){const t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{const r=e.hashCode(e);if(typeof r=="number")return r}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return me(e);if(e instanceof Date)return Ye(e.getTime());let n=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let r=0;r<e.length;r++)n=Math.imul(31,n)+S(e[r])|0;else if(e instanceof Set)e.forEach(r=>{n=n+S(r)|0});else if(e instanceof Map)e.forEach((r,s)=>{n=n+be(S(r),S(s))|0});else{const r=Object.keys(e);for(let s=0;s<r.length;s++){const i=r[s],u=e[i];n=n+be(S(u),Ee(i))|0}}return n}function S(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Ye(e);case"string":return Ee(e);case"bigint":return mt(e);case"object":return bt(e);case"symbol":return me(e);case"function":return me(e);default:return 0}}const L=5,ke=Math.pow(2,L),gt=ke-1,xt=ke/2,At=ke/4,A=0,$=1,k=2,P=3,Oe={type:k,bitmap:0,array:[]};function te(e,t){return e>>>t&gt}function oe(e,t){return 1<<te(e,t)}function _t(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Ne(e,t){return _t(e&t-1)}function z(e,t,n){const r=e.length,s=new Array(r);for(let i=0;i<r;++i)s[i]=e[i];return s[t]=n,s}function Et(e,t,n){const r=e.length,s=new Array(r+1);let i=0,u=0;for(;i<t;)s[u++]=e[i++];for(s[u++]=n;i<r;)s[u++]=e[i++];return s}function ge(e,t){const n=e.length,r=new Array(n-1);let s=0,i=0;for(;s<t;)r[i++]=e[s++];for(++s;s<n;)r[i++]=e[s++];return r}function Je(e,t,n,r,s,i){const u=S(t);if(u===r)return{type:P,hash:u,array:[{type:A,k:t,v:n},{type:A,k:s,v:i}]};const f={val:!1};return ne(Se(Oe,e,u,t,n,f),e,r,s,i,f)}function ne(e,t,n,r,s,i){switch(e.type){case $:return kt(e,t,n,r,s,i);case k:return Se(e,t,n,r,s,i);case P:return Ot(e,t,n,r,s,i)}}function kt(e,t,n,r,s,i){const u=te(n,t),f=e.array[u];if(f===void 0)return i.val=!0,{type:$,size:e.size+1,array:z(e.array,u,{type:A,k:r,v:s})};if(f.type===A)return H(r,f.k)?s===f.v?e:{type:$,size:e.size,array:z(e.array,u,{type:A,k:r,v:s})}:(i.val=!0,{type:$,size:e.size,array:z(e.array,u,Je(t+L,f.k,f.v,n,r,s))});const c=ne(f,t+L,n,r,s,i);return c===f?e:{type:$,size:e.size,array:z(e.array,u,c)}}function Se(e,t,n,r,s,i){const u=oe(n,t),f=Ne(e.bitmap,u);if(e.bitmap&u){const c=e.array[f];if(c.type!==A){const d=ne(c,t+L,n,r,s,i);return d===c?e:{type:k,bitmap:e.bitmap,array:z(e.array,f,d)}}const a=c.k;return H(r,a)?s===c.v?e:{type:k,bitmap:e.bitmap,array:z(e.array,f,{type:A,k:r,v:s})}:(i.val=!0,{type:k,bitmap:e.bitmap,array:z(e.array,f,Je(t+L,a,c.v,n,r,s))})}else{const c=e.array.length;if(c>=xt){const a=new Array(32),d=te(n,t);a[d]=Se(Oe,t+L,n,r,s,i);let b=0,E=e.bitmap;for(let g=0;g<32;g++){if(E&1){const V=e.array[b++];a[g]=V}E=E>>>1}return{type:$,size:c+1,array:a}}else{const a=Et(e.array,f,{type:A,k:r,v:s});return i.val=!0,{type:k,bitmap:e.bitmap|u,array:a}}}}function Ot(e,t,n,r,s,i){if(n===e.hash){const u=ze(e,r);if(u!==-1)return e.array[u].v===s?e:{type:P,hash:n,array:z(e.array,u,{type:A,k:r,v:s})};const f=e.array.length;return i.val=!0,{type:P,hash:n,array:z(e.array,f,{type:A,k:r,v:s})}}return ne({type:k,bitmap:oe(e.hash,t),array:[e]},t,n,r,s,i)}function ze(e,t){const n=e.array.length;for(let r=0;r<n;r++)if(H(t,e.array[r].k))return r;return-1}function fe(e,t,n,r){switch(e.type){case $:return Nt(e,t,n,r);case k:return St(e,t,n,r);case P:return zt(e,r)}}function Nt(e,t,n,r){const s=te(n,t),i=e.array[s];if(i!==void 0){if(i.type!==A)return fe(i,t+L,n,r);if(H(r,i.k))return i}}function St(e,t,n,r){const s=oe(n,t);if(!(e.bitmap&s))return;const i=Ne(e.bitmap,s),u=e.array[i];if(u.type!==A)return fe(u,t+L,n,r);if(H(r,u.k))return u}function zt(e,t){const n=ze(e,t);if(!(n<0))return e.array[n]}function Me(e,t,n,r){switch(e.type){case $:return Mt(e,t,n,r);case k:return Tt(e,t,n,r);case P:return It(e,r)}}function Mt(e,t,n,r){const s=te(n,t),i=e.array[s];if(i===void 0)return e;let u;if(i.type===A){if(!H(i.k,r))return e}else if(u=Me(i,t+L,n,r),u===i)return e;if(u===void 0){if(e.size<=At){const f=e.array,c=new Array(e.size-1);let a=0,d=0,b=0;for(;a<s;){const E=f[a];E!==void 0&&(c[d]=E,b|=1<<a,++d),++a}for(++a;a<f.length;){const E=f[a];E!==void 0&&(c[d]=E,b|=1<<a,++d),++a}return{type:k,bitmap:b,array:c}}return{type:$,size:e.size-1,array:z(e.array,s,u)}}return{type:$,size:e.size,array:z(e.array,s,u)}}function Tt(e,t,n,r){const s=oe(n,t);if(!(e.bitmap&s))return e;const i=Ne(e.bitmap,s),u=e.array[i];if(u.type!==A){const f=Me(u,t+L,n,r);return f===u?e:f!==void 0?{type:k,bitmap:e.bitmap,array:z(e.array,i,f)}:e.bitmap===s?void 0:{type:k,bitmap:e.bitmap^s,array:ge(e.array,i)}}return H(r,u.k)?e.bitmap===s?void 0:{type:k,bitmap:e.bitmap^s,array:ge(e.array,i)}:e}function It(e,t){const n=ze(e,t);if(n<0)return e;if(e.array.length!==1)return{type:P,hash:e.hash,array:ge(e.array,n)}}function Ve(e,t){if(e===void 0)return;const n=e.array,r=n.length;for(let s=0;s<r;s++){const i=n[s];if(i!==void 0){if(i.type===A){t(i.v,i.k);continue}Ve(i,t)}}}class T{static fromObject(t){const n=Object.keys(t);let r=T.new();for(let s=0;s<n.length;s++){const i=n[s];r=r.set(i,t[i])}return r}static fromMap(t){let n=T.new();return t.forEach((r,s)=>{n=n.set(s,r)}),n}static new(){return new T(void 0,0)}constructor(t,n){this.root=t,this.size=n}get(t,n){if(this.root===void 0)return n;const r=fe(this.root,0,S(t),t);return r===void 0?n:r.v}set(t,n){const r={val:!1},s=this.root===void 0?Oe:this.root,i=ne(s,0,S(t),t,n,r);return i===this.root?this:new T(i,r.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;const n=Me(this.root,0,S(t),t);return n===this.root?this:n===void 0?T.new():new T(n,this.size-1)}has(t){return this.root===void 0?!1:fe(this.root,0,S(t),t)!==void 0}entries(){if(this.root===void 0)return[];const t=[];return this.forEach((n,r)=>t.push([r,n])),t}forEach(t){Ve(this.root,t)}hashCode(){let t=0;return this.forEach((n,r)=>{t=t+be(S(n),S(r))|0}),t}equals(t){if(!(t instanceof T)||this.size!==t.size)return!1;let n=!0;return this.forEach((r,s)=>{n=n&&H(t.get(s,!r),r)}),n}}const Te=void 0,Be={};function $t(e){return/^[-+]?(\d+)$/.test(e)?new w(parseInt(e)):new O(Te)}function Lt(e){return e.toString()}function xn(e){const t=Ge(e);return t?v.fromArray(Array.from(t).map(n=>n.segment)):v.fromArray(e.match(/./gsu))}function Ge(e){if(Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function An(e){var r,s;let t;const n=Ge(e);return n?t=(r=n.next().value)==null?void 0:r.segment:t=(s=e.match(/./su))==null?void 0:s[0],t?new w([t,e.slice(t.length)]):new O(Te)}function jt(e){let t="";for(const n of e)t=t+n;return t}function _n(e,t){return e.indexOf(t)>=0}function En(){return T.new()}function qt(e,t){const n=e.get(t,Be);return n===Be?new O(Te):new w(n)}function kn(e,t,n){return n.set(e,t)}function Qe(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof ee)return"Result";if(e instanceof v)return"List";if(e instanceof ie)return"BitArray";if(e instanceof T)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{const t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Ie(e,t){return Dt(e,Qe(t))}function Dt(e,t){return new O(v.fromArray([new $e(e,t,v.fromArray([]))]))}function Ft(e){return typeof e=="string"?new w(e):Ie("String",e)}function Rt(e){return Number.isInteger(e)?new w(e):Ie("Int",e)}function Bt(e,t){const n=()=>Ie("Dict",e);if(e instanceof T||e instanceof WeakMap||e instanceof Map){const r=qt(e,t);return new w(r.isOk()?new Z(r[0]):new ue)}else return e===null?n():Object.getPrototypeOf(e)==Object.prototype?ve(e,t,()=>new w(new ue)):ve(e,t,n)}function ve(e,t,n){try{return t in e?new w(new Z(e[t])):n()}catch{return n()}}function On(e){return $t(e)}function vt(e){return Lt(e)}function Ht(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let s=n.head;e=n.tail,t=_e(s,r)}}}function Ut(e){return Ht(e,l([]))}function Wt(e,t,n){for(;;){let r=e,s=t,i=n;if(r.hasLength(0))return Ut(i);{let u=r.head;e=r.tail,t=s,n=_e(s(u),i)}}}function Pt(e,t){return Wt(e,t,l([]))}function Kt(e,t,n){for(;;){let r=e,s=t,i=n;if(r.hasLength(0))return s;{let u=r.head;e=r.tail,t=i(s,u),n=i}}}function Xt(e,t){if(e.isOk()){let n=e[0];return new w(t(n))}else{let n=e[0];return new O(n)}}function Yt(e,t){if(e.isOk()){let n=e[0];return new w(n)}else{let n=e[0];return new O(t(n))}}function He(e,t){if(e.isOk()){let n=e[0];return t(n)}else{let n=e[0];return new O(n)}}function Nn(e,t){return e.isOk()?e[0]:t()}function Sn(e,t){return e.isOk()?e:t}function zn(e,t){if(e.isOk()){let n=e[0];return new w(n)}else return new O(t)}function Jt(e){return jt(e)}function Vt(e){return e}class $e extends m{constructor(t,n,r){super(),this.expected=t,this.found=n,this.path=r}}function Le(e){return e}function Ze(e){return Qe(e)}function Gt(e){return Rt(e)}function Ce(e){return t=>{if(e.hasLength(0))return new O(l([new $e("another type",Ze(t),l([]))]));{let n=e.head,r=e.tail,s=n(t);if(s.isOk()){let i=s[0];return new w(i)}else return Ce(r)(t)}}}function Qt(e,t){let n=Le(t),r=Ce(l([Ct,i=>Xt(Gt(i),vt)])),s=(()=>{let i=r(n);if(i.isOk())return i[0];{let u=l(["<",Ze(n),">"]),f=Jt(u);return Vt(f)}})();return e.withFields({path:_e(s,e.path)})}function Zt(e,t){return Yt(e,n=>Pt(n,t))}function Ct(e){return Ft(e)}function Mn(e,t){return n=>{let r=new $e("field","nothing",l([]));return He(Bt(n,e),s=>{let u=wt(s,l([r])),f=He(u,t);return Zt(f,c=>Qt(c,e))})}}function en(e,t,n){return e?t:n()}class tn extends m{constructor(t){super(),this.all=t}}function Ue(){return new tn(l([]))}class nn extends m{constructor(t){super(),this.content=t}}class x extends m{constructor(t,n,r,s,i,u,f){super(),this.key=t,this.namespace=n,this.tag=r,this.attrs=s,this.children=i,this.self_closing=u,this.void=f}}class et extends m{constructor(t,n,r){super(),this[0]=t,this[1]=n,this.as_property=r}}class rn extends m{constructor(t,n){super(),this[0]=t,this[1]=n}}function K(e,t){return new et(e,Le(t),!1)}function sn(e,t){return new et(e,Le(t),!0)}function Tn(e,t){return new rn("on"+e,t)}function In(e){return K("style",Kt(e,"",(t,n)=>{let r=n[0],s=n[1];return t+r+":"+s+";"}))}function $n(e){return K("class",e)}function Ln(e){return K("id",e)}function jn(e){return K("placeholder",e)}function qn(e){return K("href",e)}function Dn(e){return K("src",e)}function Fn(e){return sn("width",e)}function Rn(e){return K("alt",e)}function j(e,t,n){return e==="area"?new x("","",e,t,l([]),!1,!0):e==="base"?new x("","",e,t,l([]),!1,!0):e==="br"?new x("","",e,t,l([]),!1,!0):e==="col"?new x("","",e,t,l([]),!1,!0):e==="embed"?new x("","",e,t,l([]),!1,!0):e==="hr"?new x("","",e,t,l([]),!1,!0):e==="img"?new x("","",e,t,l([]),!1,!0):e==="input"?new x("","",e,t,l([]),!1,!0):e==="link"?new x("","",e,t,l([]),!1,!0):e==="meta"?new x("","",e,t,l([]),!1,!0):e==="param"?new x("","",e,t,l([]),!1,!0):e==="source"?new x("","",e,t,l([]),!1,!0):e==="track"?new x("","",e,t,l([]),!1,!0):e==="wbr"?new x("","",e,t,l([]),!1,!0):new x("","",e,t,n,!1,!1)}function un(e){return new nn(e)}class fn extends m{constructor(t){super(),this[0]=t}}class re extends m{constructor(t){super(),this[0]=t}}class an extends m{}class cn extends m{constructor(t){super(),this[0]=t}}function We(e,t,n,r=!1){let s,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:u,next:f,parent:c}=i.pop();if(f.subtree!==void 0&&(f=f.subtree()),f.content!==void 0)if(u)if(u.nodeType===Node.TEXT_NODE)u.textContent!==f.content&&(u.textContent=f.content),s??(s=u);else{const a=document.createTextNode(f.content);c.replaceChild(a,u),s??(s=a)}else{const a=document.createTextNode(f.content);c.appendChild(a),s??(s=a)}else if(f.tag!==void 0){const a=on({prev:u,next:f,dispatch:n,stack:i,isComponent:r});u?u!==a&&c.replaceChild(a,u):c.appendChild(a),s??(s=a)}else f.elements!==void 0?le(f,a=>{i.unshift({prev:u,next:a,parent:c}),u=u==null?void 0:u.nextSibling}):f.subtree!==void 0&&i.push({prev:u,next:f,parent:c})}return s}function on({prev:e,next:t,dispatch:n,stack:r}){const s=t.namespace||"http://www.w3.org/1999/xhtml",i=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),u=i?e:s?document.createElementNS(s,t.tag):document.createElement(t.tag);let f;if(G.has(u))f=G.get(u);else{const y=new Map;G.set(u,y),f=y}const c=i?new Set(f.keys()):null,a=i?new Set(Array.from(e.attributes,y=>y.name)):null;let d=null,b=null,E=null;for(const y of t.attrs){const p=y[0],N=y[1];if(y.as_property)u[p]!==N&&(u[p]=N),i&&a.delete(p);else if(p.startsWith("on")){const R=p.slice(2),de=n(N);f.has(R)||u.addEventListener(R,Q),f.set(R,de),i&&c.delete(R)}else if(p.startsWith("data-lustre-on-")){const R=p.slice(15),de=n(ln);f.has(R)||u.addEventListener(R,Q),f.set(R,de),u.setAttribute(p,N)}else p==="class"?d=d===null?N:d+" "+N:p==="style"?b=b===null?N:b+N:p==="dangerous-unescaped-html"?E=N:(u.getAttribute(p)!==N&&u.setAttribute(p,N),(p==="value"||p==="selected")&&(u[p]=N),i&&a.delete(p))}if(d!==null&&(u.setAttribute("class",d),i&&a.delete("class")),b!==null&&(u.setAttribute("style",b),i&&a.delete("style")),i){for(const y of a)u.removeAttribute(y);for(const y of c)f.delete(y),u.removeEventListener(y,Q)}if(t.key!==void 0&&t.key!=="")u.setAttribute("data-lustre-key",t.key);else if(E!==null)return u.innerHTML=E,u;let g=u.firstChild,V=null,qe=null,De=null,he=t.children[Symbol.iterator]().next().value;i&&he!==void 0&&he.key!==void 0&&he.key!==""&&(V=new Set,qe=Pe(e),De=Pe(t));for(const y of t.children)le(y,p=>{p.key!==void 0&&V!==null?g=hn(g,p,u,r,De,qe,V):(r.unshift({prev:g,next:p,parent:u}),g=g==null?void 0:g.nextSibling)});for(;g;){const y=g.nextSibling;u.removeChild(g),g=y}return u}const G=new WeakMap;function Q(e){const t=e.currentTarget;if(!G.has(t)){t.removeEventListener(e.type,Q);return}const n=G.get(t);if(!n.has(e.type)){t.removeEventListener(e.type,Q);return}n.get(e.type)(e)}function ln(e){const t=e.currentTarget,n=t.getAttribute(`data-lustre-on-${e.type}`),r=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),s=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":s.push("target.value");break}return{tag:n,data:s.reduce((i,u)=>{var c;const f=u.split(".");for(let a=0,d=i,b=e;a<f.length;a++)a===f.length-1?d[f[a]]=b[f[a]]:(d[c=f[a]]??(d[c]={}),b=b[f[a]],d=d[f[a]]);return i},{data:r})}}function Pe(e){const t=new Map;if(e)for(const n of e.children)le(n,r=>{var i;const s=(r==null?void 0:r.key)||((i=r==null?void 0:r.getAttribute)==null?void 0:i.call(r,"data-lustre-key"));s&&t.set(s,r)});return t}function hn(e,t,n,r,s,i,u){for(;e&&!s.has(e.getAttribute("data-lustre-key"));){const c=e.nextSibling;n.removeChild(e),e=c}if(i.size===0)return le(t,c=>{r.unshift({prev:e,next:c,parent:n}),e=e==null?void 0:e.nextSibling}),e;if(u.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),r.unshift({prev:null,next:t,parent:n}),e;u.add(t.key);const f=i.get(t.key);if(!f&&!e)return r.unshift({prev:null,next:t,parent:n}),e;if(!f&&e!==null){const c=document.createTextNode("");return n.insertBefore(c,e),r.unshift({prev:c,next:t,parent:n}),e}return!f||f===e?(r.unshift({prev:e,next:t,parent:n}),e=e==null?void 0:e.nextSibling,e):(n.insertBefore(f,e),r.unshift({prev:f,next:t,parent:n}),e)}function le(e,t){if(e.elements!==void 0)for(const n of e.elements)t(n);else t(e)}var M,q,I,D,X,F,Y,W,J,se,C,Ae,ae,tt,ce,nt;const je=class je{constructor([t,n],r,s,i=document.body,u=!1){_(this,J);_(this,C);_(this,ae);_(this,ce);_(this,M,null);_(this,q,[]);_(this,I,[]);_(this,D,!1);_(this,X,!1);_(this,F,null);_(this,Y,null);_(this,W,null);o(this,F,t),o(this,Y,r),o(this,W,s),o(this,M,i),o(this,I,n.all.toArray()),o(this,D,!0),o(this,X,u),window.requestAnimationFrame(()=>B(this,J,se).call(this))}static start(t,n,r,s,i){if(!rt())return new O(new st);const u=n instanceof HTMLElement?n:document.querySelector(n);if(!u)return new O(new yn(n));const f=new je(r(t),s,i,u);return new w(c=>f.send(c))}send(t){switch(!0){case t instanceof re:{h(this,q).push(t[0]),B(this,J,se).call(this);return}case t instanceof an:{B(this,ce,nt).call(this);return}case t instanceof fn:{B(this,ae,tt).call(this,t[0]);return}default:return}}emit(t,n){h(this,M).dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:n,composed:!0}))}};M=new WeakMap,q=new WeakMap,I=new WeakMap,D=new WeakMap,X=new WeakMap,F=new WeakMap,Y=new WeakMap,W=new WeakMap,J=new WeakSet,se=function(){if(B(this,C,Ae).call(this),h(this,D)){const t=h(this,W).call(this,h(this,F)),n=r=>s=>{const i=r(s);i instanceof w&&this.send(new re(i[0]))};o(this,D,!1),o(this,M,We(h(this,M),t,n,h(this,X)))}},C=new WeakSet,Ae=function(t=0){for(;h(this,q).length;){const[n,r]=h(this,Y).call(this,h(this,F),h(this,q).shift());h(this,D)||o(this,D,h(this,F)!==n),o(this,F,n),o(this,I,h(this,I).concat(r.all.toArray()))}for(;h(this,I).length;)h(this,I).shift()(n=>this.send(new re(n)),(n,r)=>this.emit(n,r));h(this,q).length&&(t<5?B(this,C,Ae).call(this,++t):window.requestAnimationFrame(()=>B(this,J,se).call(this)))},ae=new WeakSet,tt=function(t){switch(!0){case t instanceof cn:{const n=h(this,W).call(this,t[0]),r=s=>i=>{const u=s(i);u instanceof w&&this.send(new re(u[0]))};o(this,q,[]),o(this,I,[]),o(this,D,!1),o(this,M,We(h(this,M),n,r,h(this,X)))}}},ce=new WeakSet,nt=function(){h(this,M).remove(),o(this,M,null),o(this,F,null),o(this,q,[]),o(this,I,[]),o(this,D,!1),o(this,Y,()=>{}),o(this,W,()=>{})};let xe=je;const dn=(e,t,n)=>xe.start(n,t,e.init,e.update,e.view),rt=()=>globalThis.window&&window.document;class pn extends m{constructor(t,n,r,s){super(),this.init=t,this.update=n,this.view=r,this.on_attribute_change=s}}class yn extends m{constructor(t){super(),this.selector=t}}class st extends m{}function wn(e,t,n){return new pn(e,t,n,new ue)}function Bn(e,t,n){return wn(i=>[e(i),Ue()],(i,u)=>[t(i,u),Ue()],n)}function vn(e,t,n){return en(!rt(),new O(new st),()=>dn(e,t,n))}function Hn(e,t){return j("h3",e,t)}function Un(e,t){return j("div",e,t)}function Wn(e,t){return j("p",e,t)}function Pn(e,t){return j("a",e,t)}function Kn(e){return j("br",e,l([]))}function Xn(e,t){return j("code",e,t)}function Yn(e,t){return j("span",e,t)}function Jn(e,t){return j("strong",e,t)}function Vn(e){return j("img",e,l([]))}function Gn(e,t){return j("textarea",e,l([un(t)]))}export{Mn as A,Ct as B,m as C,xn as D,O as E,Sn as F,_e as G,_n as H,He as I,zn as J,vt as K,Kt as L,On as M,Nn as N,w as O,ue as P,Yt as Q,gn as R,Z as S,Xn as T,Gn as U,jn as V,Kn as W,Jn as X,vn as a,Vn as b,Dn as c,Un as d,$n as e,un as f,Pn as g,Hn as h,Ln as i,qn as j,Rn as k,Yn as l,bn as m,In as n,qt as o,Wn as p,kn as q,En as r,Bn as s,l as t,Jt as u,Vt as v,Fn as w,An as x,Tn as y,Xt as z};
